import { createI18n } from 'vue-i18n';
import ru from '../locales/ru.js';
import en from '../locales/en.js';

// ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ÑĞµĞ¼ Ğ»Ğ¾ĞºĞ°Ğ»ÑŒ Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ
const defaultLocale = localStorage.getItem('locale') || 'ru';

// Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµĞ¼ ÑĞºĞ·ĞµĞ¼Ğ¿Ğ»ÑÑ€ i18n
const i18n = createI18n({
  legacy: false, // Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Composition API mode
  locale: defaultLocale,
  fallbackLocale: 'ru',
  messages: {
    ru,
    en
  },
  // ĞĞ¿Ñ†Ğ¸Ğ¸ Ğ´Ğ»Ñ Ğ¿Ğ»ÑÑ€Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸, ĞµÑĞ»Ğ¸ Ğ½ÑƒĞ¶Ğ½Ñ‹
  pluralizationRules: {
    ru: function(choice, choicesLength) {
      // Ğ”Ğ»Ñ Ñ€ÑƒÑÑĞºĞ¾Ğ³Ğ¾ ÑĞ·Ñ‹ĞºĞ° ÑĞ¿ĞµÑ†Ğ¸Ñ„Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ° Ğ¼Ğ½Ğ¾Ğ¶ĞµÑÑ‚Ğ²ĞµĞ½Ğ½Ğ¾Ğ³Ğ¾ Ñ‡Ğ¸ÑĞ»Ğ°
      if (choice === 0) {
        return 0;
      }

      const teen = choice > 10 && choice < 20;
      const endsWithOne = choice % 10 === 1;

      if (!teen && endsWithOne) {
        return 1;
      }
      if (!teen && choice % 10 >= 2 && choice % 10 <= 4) {
        return 2;
      }
      return 3;
    }
  }
});

// Ğ’ÑĞ¿Ğ¾Ğ¼Ğ¾Ğ³Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ Ğ´Ğ»Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ Ñ ÑĞ·Ñ‹ĞºĞ°Ğ¼Ğ¸
export const setLocale = (locale) => {
  i18n.global.locale.value = locale;
  localStorage.setItem('locale', locale);
  document.querySelector('html').setAttribute('lang', locale);
};

export const getLocale = () => {
  return i18n.global.locale.value;
};

export const availableLocales = [
  { code: 'ru', name: 'Ğ ÑƒÑÑĞºĞ¸Ğ¹', flag: 'ğŸ‡·ğŸ‡º' },
  { code: 'en', name: 'English', flag: 'ğŸ‡¬ğŸ‡§' }
];

export default i18n; 